last executing test programs:

8.514743588s ago: executing program 5 (id=263):
syz_open_dev$hidraw(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$hidraw(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$hidraw(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$hidraw(&(0x7f0000000100), 0x0, 0x800)
syz_open_dev$hidraw(&(0x7f0000000140), 0x1, 0x0)
syz_open_dev$hidraw(&(0x7f0000000180), 0x1, 0x1)
syz_open_dev$hidraw(&(0x7f00000001c0), 0x1, 0x2)
syz_open_dev$hidraw(&(0x7f0000000200), 0x1, 0x800)
syz_open_dev$hidraw(&(0x7f0000000240), 0x2, 0x0)
syz_open_dev$hidraw(&(0x7f0000000280), 0x2, 0x1)
syz_open_dev$hidraw(&(0x7f00000002c0), 0x2, 0x2)
syz_open_dev$hidraw(&(0x7f0000000300), 0x2, 0x800)
syz_open_dev$hidraw(&(0x7f0000000340), 0x3, 0x0)
syz_open_dev$hidraw(&(0x7f0000000380), 0x3, 0x1)
syz_open_dev$hidraw(&(0x7f00000003c0), 0x3, 0x2)
syz_open_dev$hidraw(&(0x7f0000000400), 0x3, 0x800)
syz_open_dev$hidraw(&(0x7f0000000440), 0x4, 0x0)
syz_open_dev$hidraw(&(0x7f0000000480), 0x4, 0x1)
syz_open_dev$hidraw(&(0x7f00000004c0), 0x4, 0x2)
syz_open_dev$hidraw(&(0x7f0000000500), 0x4, 0x800)

5.914494712s ago: executing program 5 (id=280):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/fuse', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/fuse', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/fuse', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/fuse', 0x800, 0x0)

5.300653858s ago: executing program 5 (id=286):
fspick(0xffffffffffffffff, &(0x7f0000000000), 0x0)

4.704816189s ago: executing program 5 (id=290):
munmap(0x0, 0x0)

4.209725953s ago: executing program 2 (id=295):
shmdt(0x0)

4.063517578s ago: executing program 5 (id=296):
syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)

3.753406996s ago: executing program 3 (id=299):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/video2', 0x2, 0x0)

3.514384675s ago: executing program 0 (id=300):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/proc/sys/net/ipv4/tcp_rmem', 0x1, 0x0)

3.513642448s ago: executing program 2 (id=301):
process_vm_readv(0x0, &(0x7f0000000000), 0x0, &(0x7f0000000000), 0x0, 0x0)

3.391191261s ago: executing program 1 (id=302):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/vcsa', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/vcsa', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/vcsa', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/vcsa', 0x800, 0x0)

3.34211521s ago: executing program 4 (id=303):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/sys/fs/smackfs/direct', 0x2, 0x0)

3.132644445s ago: executing program 3 (id=304):
futex(&(0x7f0000000000), 0x0, 0x0, &(0x7f0000000000), &(0x7f0000000000), 0x0)

3.015573889s ago: executing program 2 (id=305):
pipe2(&(0x7f0000000000), 0x0)

2.905559014s ago: executing program 0 (id=306):
sched_getparam(0x0, &(0x7f0000000000))

2.761674886s ago: executing program 4 (id=307):
pidfd_getfd(0xffffffffffffffff, 0xffffffffffffffff, 0x0)

2.60072449s ago: executing program 1 (id=308):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/selinux/avc/cache_stats', 0x0, 0x0)

2.462539523s ago: executing program 3 (id=309):
syz_open_dev$amidi(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$amidi(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$amidi(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$amidi(&(0x7f0000000100), 0x0, 0x800)
syz_open_dev$amidi(&(0x7f0000000140), 0x1, 0x0)
syz_open_dev$amidi(&(0x7f0000000180), 0x1, 0x1)
syz_open_dev$amidi(&(0x7f00000001c0), 0x1, 0x2)
syz_open_dev$amidi(&(0x7f0000000200), 0x1, 0x800)
syz_open_dev$amidi(&(0x7f0000000240), 0x2, 0x0)
syz_open_dev$amidi(&(0x7f0000000280), 0x2, 0x1)
syz_open_dev$amidi(&(0x7f00000002c0), 0x2, 0x2)
syz_open_dev$amidi(&(0x7f0000000300), 0x2, 0x800)
syz_open_dev$amidi(&(0x7f0000000340), 0x3, 0x0)
syz_open_dev$amidi(&(0x7f0000000380), 0x3, 0x1)
syz_open_dev$amidi(&(0x7f00000003c0), 0x3, 0x2)
syz_open_dev$amidi(&(0x7f0000000400), 0x3, 0x800)
syz_open_dev$amidi(&(0x7f0000000440), 0x4, 0x0)
syz_open_dev$amidi(&(0x7f0000000480), 0x4, 0x1)
syz_open_dev$amidi(&(0x7f00000004c0), 0x4, 0x2)
syz_open_dev$amidi(&(0x7f0000000500), 0x4, 0x800)

2.387698581s ago: executing program 2 (id=310):
syz_init_net_socket$x25(0x9, 0x5, 0x0)

2.185980274s ago: executing program 0 (id=311):
writev(0xffffffffffffffff, &(0x7f0000000000), 0x0)

2.185599198s ago: executing program 4 (id=312):
pselect6(0x0, &(0x7f0000000000), &(0x7f0000000000), &(0x7f0000000000), &(0x7f0000000000), &(0x7f0000000000))

2.043733901s ago: executing program 5 (id=313):
syz_open_dev$audion(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$audion(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$audion(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$audion(&(0x7f0000000100), 0x0, 0x800)
syz_open_dev$audion(&(0x7f0000000140), 0x1, 0x0)
syz_open_dev$audion(&(0x7f0000000180), 0x1, 0x1)
syz_open_dev$audion(&(0x7f00000001c0), 0x1, 0x2)
syz_open_dev$audion(&(0x7f0000000200), 0x1, 0x800)
syz_open_dev$audion(&(0x7f0000000240), 0x2, 0x0)
syz_open_dev$audion(&(0x7f0000000280), 0x2, 0x1)
syz_open_dev$audion(&(0x7f00000002c0), 0x2, 0x2)
syz_open_dev$audion(&(0x7f0000000300), 0x2, 0x800)
syz_open_dev$audion(&(0x7f0000000340), 0x3, 0x0)
syz_open_dev$audion(&(0x7f0000000380), 0x3, 0x1)
syz_open_dev$audion(&(0x7f00000003c0), 0x3, 0x2)
syz_open_dev$audion(&(0x7f0000000400), 0x3, 0x800)
syz_open_dev$audion(&(0x7f0000000440), 0x4, 0x0)
syz_open_dev$audion(&(0x7f0000000480), 0x4, 0x1)
syz_open_dev$audion(&(0x7f00000004c0), 0x4, 0x2)
syz_open_dev$audion(&(0x7f0000000500), 0x4, 0x800)

1.896650393s ago: executing program 1 (id=314):
getrandom(&(0x7f0000000000), 0x0, 0x0)

1.651361355s ago: executing program 0 (id=315):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/selinux/enforce', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/selinux/enforce', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/selinux/enforce', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/selinux/enforce', 0x800, 0x0)

1.650648363s ago: executing program 3 (id=316):
symlinkat(&(0x7f0000000000), 0xffffffffffffffff, &(0x7f0000000000))

1.521777921s ago: executing program 4 (id=317):
epoll_pwait2(0xffffffffffffffff, &(0x7f0000000000), 0x0, &(0x7f0000000000), &(0x7f0000000000), 0x0)

1.343803443s ago: executing program 1 (id=318):
faccessat(0xffffffffffffffff, &(0x7f0000000000), 0x0)

1.020890273s ago: executing program 0 (id=319):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/vim2m', 0x2, 0x0)

1.020208363s ago: executing program 3 (id=320):
cachestat(0xffffffffffffffff, &(0x7f0000000000), &(0x7f0000000000), 0x0)

884.691248ms ago: executing program 4 (id=321):
semget(0xffffffffffffffff, 0x0, 0x0)

753.905772ms ago: executing program 1 (id=322):
unshare(0x0)

634.633195ms ago: executing program 2 (id=323):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/proc/keys', 0x0, 0x0)

409.781386ms ago: executing program 0 (id=324):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/btrfs-control', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/btrfs-control', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/btrfs-control', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/btrfs-control', 0x800, 0x0)

359.761454ms ago: executing program 3 (id=325):
clock_gettime(0x0, &(0x7f0000000000))

284.565486ms ago: executing program 4 (id=326):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/v4l/by-path/platform-soc@0:qcom_cam-req-mgr-video-index0', 0x2, 0x0)

16.675595ms ago: executing program 1 (id=327):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/video36', 0x2, 0x0)

0s ago: executing program 2 (id=328):
io_getevents(0x0, 0x0, 0x0, &(0x7f0000000000), 0x0)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:3506' (ED25519) to the list of known hosts.
buildroot login: [  145.842915][ T2952] cgroup: Unknown subsys name 'net'
[  146.193830][ T2952] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 127995904 bytes
[  172.665784][ T2952] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[  189.236299][ T3111] syz.2.23[3111]: memfd_create() called without MFD_EXEC or MFD_NOEXEC_SEAL set
[  211.088418][ T3313] mmap: syz.3.213 (3313) uses deprecated remap_file_pages() syscall. See Documentation/mm/remap_file_pages.rst.
[  227.183957][    C1] hrtimer: interrupt took 1961400 ns
[  227.186489][    C1] 
[  227.186771][    C1] =============================
[  227.186995][    C1] [ BUG: Invalid wait context ]
[  227.187518][    C1] 6.6.0 #1 Not tainted
[  227.187887][    C1] -----------------------------
[  227.188071][    C1] syz.4.326/3434 is trying to lock:
[  227.188465][    C1] ffffffff903aa398 (&port_lock_key){-.-.}-{3:3}, at: serial8250_console_write+0x526/0xe4c
[  227.193285][    C1] other info that might help us debug this:
[  227.193621][    C1] context-{2:2}
[  227.193962][    C1] 6 locks held by syz.4.326/3434:
[  227.194325][    C1]  #0: ff6000008d1e3490 (&mm->mmap_lock){++++}-{4:4}, at: exit_mmap+0x136/0xab0
[  227.195994][    C1]  #1: ffffffff879c5d00 (rcu_read_lock){....}-{1:3}, at: __pte_offset_map+0x0/0x30a
[  227.197527][    C1]  #2: ff6000008c01ad38 (ptlock_ptr(ptdesc)){+.+.}-{3:3}, at: __pte_offset_map_lock+0x1a8/0x382
[  227.198503][    C1]  #3: ffffffff878d5600 (console_lock){+.+.}-{0:0}, at: vprintk_emit+0x174/0x672
[  227.199119][    C1]  #4: ffffffff878d5710 (console_srcu){....}-{0:0}, at: console_flush_all+0xea/0xe04
[  227.199704][    C1]  #5: ffffffff878d58c0 (console_owner){-...}-{0:0}, at: console_flush_all+0x47a/0xe04
[  227.200334][    C1] stack backtrace:
[  227.200687][    C1] CPU: 1 PID: 3434 Comm: syz.4.326 Not tainted 6.6.0 #1
[  227.200958][    C1] Hardware name: riscv-virtio,qemu (DT)
[  227.201333][    C1] Call Trace:
[  227.201497][    C1] [<ffffffff8000dc50>] dump_backtrace+0x32/0x3c
[  227.201832][    C1] [<ffffffff85aeb8b6>] show_stack+0x34/0x40
[  227.202113][    C1] [<ffffffff85b4131c>] dump_stack_lvl+0xe2/0x14c
[  227.202478][    C1] [<ffffffff85b413a2>] dump_stack+0x1c/0x24
[  227.202799][    C1] [<ffffffff8023e890>] __lock_acquire+0x6de2/0x6f34
[  227.203090][    C1] [<ffffffff8023ed30>] lock_acquire+0x34e/0xd20
[  227.203370][    C1] [<ffffffff85b651a6>] _raw_spin_lock_irqsave+0x3e/0x62
[  227.203690][    C1] [<ffffffff81ac83a6>] serial8250_console_write+0x526/0xe4c
[  227.204016][    C1] [<ffffffff81ab094e>] univ8250_console_write+0x66/0x9c
[  227.204276][    C1] [<ffffffff80258dc8>] console_flush_all+0x4fa/0xe04
[  227.204539][    C1] [<ffffffff802597fe>] console_unlock+0x12c/0x270
[  227.204784][    C1] [<ffffffff8025d694>] vprintk_emit+0x192/0x672
[  227.205035][    C1] [<ffffffff8025db9e>] vprintk_default+0x2a/0x32
[  227.205297][    C1] [<ffffffff8025f24a>] vprintk+0x1d4/0x258
[  227.205549][    C1] [<ffffffff85af0106>] _printk+0x9a/0xc0
[  227.205810][    C1] [<ffffffff8031f384>] hrtimer_interrupt+0x79a/0x79c
[  227.206141][    C1] [<ffffffff84192570>] riscv_timer_interrupt+0x7a/0xcc
[  227.206466][    C1] [<ffffffff8027c4da>] handle_percpu_devid_irq+0x284/0x59e
[  227.206714][    C1] [<ffffffff80265bd4>] generic_handle_domain_irq+0x76/0xaa
[  227.206995][    C1] [<ffffffff816e7b9e>] riscv_intc_irq+0x6e/0xa2
[  227.207297][    C1] [<ffffffff85b424e4>] handle_riscv_irq+0x2e/0x4c
[  227.207657][    C1] [<ffffffff85b42b7a>] do_irq+0x6a/0xb4
SYZFAIL: failed to recv rpc
fd=3 want=4 recv=0 n=0 (errno 9: Bad file descriptor)

VM DIAGNOSIS:
09:59:32  Registers:
info registers vcpu 0
 pc       ffffffff85b651a6
 mhartid  0000000000000000
 mstatus  0000000a000000a2
 mip      0000000000000000
 mie      00000000000002aa
 mideleg  0000000000000222
 medeleg  000000000000b109
 mtvec    0000000080000520
 stvec    ffffffff80006e1c
 mepc     ffffffff80017912
 sepc     ffffffff85b4f8e2
 mcause   0000000000000009
 scause   8000000000000009
 mtval    0000000000000000
 stval    0000000000000000
 mscratch 000000008001a000
 sscratch 0000000000000000
 satp     a01f20000011def3
 x0/zero  0000000000000000 x1/ra    ffffffff8000d970 x2/sp    ff2000000193b470 x3/gp    ffffffff890652c0
 x4/tp    ff6000008c68e600 x5/t0    ff2000000193b6c0 x6/t1    00000000000f0000 x7/t2    ffffffff87223478
 x8/s0    ff2000000193b7c0 x9/s1    0000000000000001 x10/a0   ffffffff879c5d00 x11/a1   00000000000f0000
 x12/a2   0000000000000000 x13/a3   0000000000000002 x14/a4   0000000000000000 x15/a5   ffebffff10926d23
 x16/a6   0000000000000003 x17/a7   0000000041b58ab3 x18/s2   ffffffff90358ff8 x19/s3   ffffffff81483b46
 x20/s4   000000000010c503 x21/s5   0000000000000001 x22/s6   0000000000000000 x23/s7   ffebffff1135c1d4
 x24/s8   ff6000008e3e8040 x25/s9   ff60000089ae0ea0 x26/s10  ff60000089ae0eac x27/s11  1fec000010d57dc0
 x28/t3   0000000000f00000 x29/t4   ffe37fff00882116 x30/t5   ffe37fff00882117 x31/t6   fffffffff3000000
 f0/ft0   0000000000000000 f1/ft1   0000000000000000 f2/ft2   0000000000000000 f3/ft3   0000000000000000
 f4/ft4   0000000000000000 f5/ft5   0000000000000000 f6/ft6   0000000000000000 f7/ft7   0000000000000000
 f8/fs0   0000000000000000 f9/fs1   0000000000000000 f10/fa0  0000000000000000 f11/fa1  0000000000000000
 f12/fa2  0000000000000000 f13/fa3  0000000000000000 f14/fa4  0000000000000000 f15/fa5  0000000000000000
 f16/fa6  0000000000000000 f17/fa7  0000000000000000 f18/fs2  0000000000000000 f19/fs3  0000000000000000
 f20/fs4  0000000000000000 f21/fs5  0000000000000000 f22/fs6  0000000000000000 f23/fs7  0000000000000000
 f24/fs8  0000000000000000 f25/fs9  0000000000000000 f26/fs10 0000000000000000 f27/fs11 0000000000000000
 f28/ft8  0000000000000000 f29/ft9  0000000000000000 f30/ft10 0000000000000000 f31/ft11 0000000000000000
info registers vcpu 1
 pc       ffffffff81ab9390
 mhartid  0000000000000001
 mstatus  0000000a000001a0
 mip      00000000000000a0
 mie      000000000000022a
 mideleg  0000000000000222
 medeleg  000000000000b109
 mtvec    0000000080000520
 stvec    ffffffff80006e1c
 mepc     ffffffff8030a040
 sepc     ffffffff807d3856
 mcause   8000000000000007
 scause   8000000000000005
 mtval    0000000000000000
 stval    0000000000000000
 mscratch 0000000080018000
 sscratch 0000000000000000
 satp     a01f00000011e359
 x0/zero  0000000000000000 x1/ra    ffffffff81ab9390 x2/sp    ff2000000000b810 x3/gp    ffffffff890652c0
 x4/tp    ff6000008d316600 x5/t0    ffffffff8023e9e2 x6/t1    00000000000f0000 x7/t2    ffffffff87223478
 x8/s0    ff2000000000b850 x9/s1    ffffffff903aa380 x10/a0   ffffffff903aa3c8 x11/a1   0000000000000001
 x12/a2   0000000000010000 x13/a3   0000000000000000 x14/a4   1ffffffff2075479 x15/a5   ff2000000009d001
 x16/a6   0000000000000000 x17/a7   0000000000010000 x18/s2   0000000000000005 x19/s3   0000000000000001
 x20/s4   0000000000000005 x21/s5   0000000000000002 x22/s6   0000000000000120 x23/s7   0000000000000001
 x24/s8   ffffffff903aa3d8 x25/s9   000000000000000a x26/s10  0000000000000010 x27/s11  ffffffff81ab9332
 x28/t3   0000000000f00000 x29/t4   fffffffef2075470 x30/t5   fffffffef2075471 x31/t6   fffffffff3000000
 f0/ft0   0000000000000000 f1/ft1   0000000000000000 f2/ft2   0000000000000000 f3/ft3   0000000000000000
 f4/ft4   0000000000000000 f5/ft5   0000000000000000 f6/ft6   0000000000000000 f7/ft7   0000000000000000
 f8/fs0   0000000000000000 f9/fs1   0000000000000000 f10/fa0  0000000000000000 f11/fa1  0000000000000000
 f12/fa2  0000000000000000 f13/fa3  0000000000000000 f14/fa4  0000000000000000 f15/fa5  0000000000000000
 f16/fa6  0000000000000000 f17/fa7  0000000000000000 f18/fs2  0000000000000000 f19/fs3  0000000000000000
 f20/fs4  0000000000000000 f21/fs5  0000000000000000 f22/fs6  0000000000000000 f23/fs7  0000000000000000
 f24/fs8  0000000000000000 f25/fs9  0000000000000000 f26/fs10 0000000000000000 f27/fs11 0000000000000000
 f28/ft8  0000000000000000 f29/ft9  0000000000000000 f30/ft10 0000000000000000 f31/ft11 0000000000000000
