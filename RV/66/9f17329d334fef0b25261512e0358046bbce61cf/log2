last executing test programs:

3.607058826s ago: executing program 4 (id=57):
getuid()

3.606663737s ago: executing program 5 (id=58):
io_cancel(0x0, &(0x7f0000000000), &(0x7f0000000000))

3.468665277s ago: executing program 0 (id=59):
getegid()

3.217700189s ago: executing program 3 (id=60):
vmsplice(0xffffffffffffffff, &(0x7f0000000000), 0x0, 0x0)

3.213566419s ago: executing program 1 (id=61):
setfsgid(0x0)

3.213268894s ago: executing program 2 (id=62):
statfs(&(0x7f0000000000), &(0x7f0000000000))

3.027013331s ago: executing program 4 (id=63):
timerfd_settime(0xffffffffffffffff, 0x0, &(0x7f0000000000), &(0x7f0000000000))

2.999036878s ago: executing program 5 (id=64):
timerfd_gettime(0xffffffffffffffff, &(0x7f0000000000))

2.964635943s ago: executing program 0 (id=65):
syz_open_dev$loop(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$loop(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$loop(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$loop(&(0x7f0000000100), 0x0, 0x800)
syz_open_dev$loop(&(0x7f0000000140), 0x1, 0x0)
syz_open_dev$loop(&(0x7f0000000180), 0x1, 0x1)
syz_open_dev$loop(&(0x7f00000001c0), 0x1, 0x2)
syz_open_dev$loop(&(0x7f0000000200), 0x1, 0x800)
syz_open_dev$loop(&(0x7f0000000240), 0x2, 0x0)
syz_open_dev$loop(&(0x7f0000000280), 0x2, 0x1)
syz_open_dev$loop(&(0x7f00000002c0), 0x2, 0x2)
syz_open_dev$loop(&(0x7f0000000300), 0x2, 0x800)
syz_open_dev$loop(&(0x7f0000000340), 0x3, 0x0)
syz_open_dev$loop(&(0x7f0000000380), 0x3, 0x1)
syz_open_dev$loop(&(0x7f00000003c0), 0x3, 0x2)
syz_open_dev$loop(&(0x7f0000000400), 0x3, 0x800)
syz_open_dev$loop(&(0x7f0000000440), 0x4, 0x0)
syz_open_dev$loop(&(0x7f0000000480), 0x4, 0x1)
syz_open_dev$loop(&(0x7f00000004c0), 0x4, 0x2)
syz_open_dev$loop(&(0x7f0000000500), 0x4, 0x800)

2.695275958s ago: executing program 3 (id=66):
exit_group(0x0)

2.563851612s ago: executing program 2 (id=67):
dup(0xffffffffffffffff)

2.493005667s ago: executing program 1 (id=68):
mremap(0x0, 0x0, 0x0, 0x0, 0x0)

2.3442062s ago: executing program 4 (id=69):
init_module(&(0x7f0000000000), 0x0, &(0x7f0000000000))

2.343850956s ago: executing program 5 (id=70):
listen(0xffffffffffffffff, 0x0)

2.052358457s ago: executing program 2 (id=71):
sched_getattr(0x0, &(0x7f0000000000), 0x0, 0x0)

2.009712712s ago: executing program 0 (id=72):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/selinux/load', 0x2, 0x0)

2.00942173s ago: executing program 3 (id=73):
request_key(&(0x7f0000000000), &(0x7f0000000000), &(0x7f0000000000), 0x0)

1.712544966s ago: executing program 1 (id=74):
mount_setattr(0xffffffffffffffff, &(0x7f0000000000), 0x0, &(0x7f0000000000), 0x0)

1.712214533s ago: executing program 5 (id=75):
syncfs(0xffffffffffffffff)

1.63475546s ago: executing program 4 (id=76):
syz_open_dev$ndb(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$ndb(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$ndb(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$ndb(&(0x7f0000000100), 0x0, 0x800)

1.493377208s ago: executing program 2 (id=77):
landlock_add_rule$LANDLOCK_RULE_NET_PORT(0xffffffffffffffff, 0x2, &(0x7f0000000000), 0x0)

1.403725654s ago: executing program 0 (id=78):
getpid()

1.373134943s ago: executing program 3 (id=79):
syz_open_dev$floppy(&(0x7f0000000040), 0x0, 0x0)
syz_open_dev$floppy(&(0x7f0000000080), 0x0, 0x1)
syz_open_dev$floppy(&(0x7f00000000c0), 0x0, 0x2)
syz_open_dev$floppy(&(0x7f0000000100), 0x0, 0x800)
syz_open_dev$floppy(&(0x7f0000000140), 0x1, 0x0)
syz_open_dev$floppy(&(0x7f0000000180), 0x1, 0x1)
syz_open_dev$floppy(&(0x7f00000001c0), 0x1, 0x2)
syz_open_dev$floppy(&(0x7f0000000200), 0x1, 0x800)
syz_open_dev$floppy(&(0x7f0000000240), 0x2, 0x0)
syz_open_dev$floppy(&(0x7f0000000280), 0x2, 0x1)
syz_open_dev$floppy(&(0x7f00000002c0), 0x2, 0x2)
syz_open_dev$floppy(&(0x7f0000000300), 0x2, 0x800)
syz_open_dev$floppy(&(0x7f0000000340), 0x3, 0x0)
syz_open_dev$floppy(&(0x7f0000000380), 0x3, 0x1)
syz_open_dev$floppy(&(0x7f00000003c0), 0x3, 0x2)
syz_open_dev$floppy(&(0x7f0000000400), 0x3, 0x800)
syz_open_dev$floppy(&(0x7f0000000440), 0x4, 0x0)
syz_open_dev$floppy(&(0x7f0000000480), 0x4, 0x1)
syz_open_dev$floppy(&(0x7f00000004c0), 0x4, 0x2)
syz_open_dev$floppy(&(0x7f0000000500), 0x4, 0x800)

1.127161268s ago: executing program 1 (id=80):
clock_settime(0x0, &(0x7f0000000000))

1.060966253s ago: executing program 5 (id=81):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/qrtr-tun', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/qrtr-tun', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/qrtr-tun', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/qrtr-tun', 0x800, 0x0)

842.187389ms ago: executing program 2 (id=82):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/sys/fs/smackfs/relabel-self', 0x2, 0x0)

841.147414ms ago: executing program 0 (id=83):
tee(0xffffffffffffffff, 0xffffffffffffffff, 0x0, 0x0)

840.910068ms ago: executing program 4 (id=84):
setresuid(0x0, 0x0, 0x0)

624.034914ms ago: executing program 3 (id=85):
close_range(0xffffffffffffffff, 0xffffffffffffffff, 0x0)

623.161647ms ago: executing program 1 (id=86):
msync(0x0, 0x0, 0x0)

333.55738ms ago: executing program 5 (id=87):
getrlimit(0x0, &(0x7f0000000000))

265.412576ms ago: executing program 2 (id=88):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/sys/kernel/debug/binder/failed_transaction_log', 0x0, 0x0)

165.916718ms ago: executing program 0 (id=89):
socket$unix(0x1, 0x1, 0x0)

132.346325ms ago: executing program 4 (id=90):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/cdrom', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/cdrom', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/cdrom', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/cdrom', 0x800, 0x0)

131.893411ms ago: executing program 1 (id=91):
openat(0xffffffffffffff9c, &(0x7f0000000040)='/dev/nvme-fabrics', 0x0, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000080)='/dev/nvme-fabrics', 0x1, 0x0)
openat(0xffffffffffffff9c, &(0x7f00000000c0)='/dev/nvme-fabrics', 0x2, 0x0)
openat(0xffffffffffffff9c, &(0x7f0000000100)='/dev/nvme-fabrics', 0x800, 0x0)

0s ago: executing program 3 (id=92):
io_destroy(0x0)

kernel console output (not intermixed with test programs):

Warning: Permanently added '[localhost]:7964' (ED25519) to the list of known hosts.
buildroot login: [  152.187281][ T2956] cgroup: Unknown subsys name 'net'
[  152.598980][ T2956] cgroup: Unknown subsys name 'rlimit'
Setting up swapspace version 1, size = 127995904 bytes
[  179.919662][ T2956] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
[  202.113776][ T3131] UDPLite6: UDP-Lite is deprecated and scheduled to be removed in 2025, please contact the netdev mailing list
[  208.503517][    C1] hrtimer: interrupt took 1326600 ns
[  208.504775][    C1] 
[  208.504929][    C1] =============================
[  208.505059][    C1] [ BUG: Invalid wait context ]
[  208.505335][    C1] 6.6.0 #1 Not tainted
[  208.505794][    C1] -----------------------------
[  208.505905][    C1] syz-executor/3186 is trying to lock:
[  208.506140][    C1] ffffffff903aa398 (&port_lock_key){-.-.}-{3:3}, at: serial8250_console_write+0x526/0xe4c
[  208.508918][    C1] other info that might help us debug this:
[  208.509121][    C1] context-{2:2}
[  208.509340][    C1] 3 locks held by syz-executor/3186:
[  208.509542][    C1]  #0: ffffffff878d5600 (console_lock){+.+.}-{0:0}, at: vprintk_emit+0x174/0x672
[  208.510465][    C1]  #1: ffffffff878d5710 (console_srcu){....}-{0:0}, at: console_flush_all+0xea/0xe04
[  208.511245][    C1]  #2: ffffffff878d58c0 (console_owner){-...}-{0:0}, at: console_flush_all+0x47a/0xe04
[  208.512058][    C1] stack backtrace:
[  208.512526][    C1] CPU: 1 PID: 3186 Comm: syz-executor Not tainted 6.6.0 #1
[  208.512921][    C1] Hardware name: riscv-virtio,qemu (DT)
[  208.513381][    C1] Call Trace:
[  208.513582][    C1] [<ffffffff8000dc50>] dump_backtrace+0x32/0x3c
[  208.514013][    C1] [<ffffffff85aeb8b6>] show_stack+0x34/0x40
[  208.514305][    C1] [<ffffffff85b4131c>] dump_stack_lvl+0xe2/0x14c
[  208.514737][    C1] [<ffffffff85b413a2>] dump_stack+0x1c/0x24
[  208.515146][    C1] [<ffffffff8023e890>] __lock_acquire+0x6de2/0x6f34
[  208.515505][    C1] [<ffffffff8023ed30>] lock_acquire+0x34e/0xd20
[  208.515844][    C1] [<ffffffff85b651a6>] _raw_spin_lock_irqsave+0x3e/0x62
[  208.516235][    C1] [<ffffffff81ac83a6>] serial8250_console_write+0x526/0xe4c
[  208.516634][    C1] [<ffffffff81ab094e>] univ8250_console_write+0x66/0x9c
[  208.516964][    C1] [<ffffffff80258dc8>] console_flush_all+0x4fa/0xe04
[  208.517288][    C1] [<ffffffff802597fe>] console_unlock+0x12c/0x270
[  208.517606][    C1] [<ffffffff8025d694>] vprintk_emit+0x192/0x672
[  208.517919][    C1] [<ffffffff8025db9e>] vprintk_default+0x2a/0x32
[  208.518263][    C1] [<ffffffff8025f24a>] vprintk+0x1d4/0x258
[  208.518590][    C1] [<ffffffff85af0106>] _printk+0x9a/0xc0
[  208.518943][    C1] [<ffffffff8031f384>] hrtimer_interrupt+0x79a/0x79c
[  208.519380][    C1] [<ffffffff84192570>] riscv_timer_interrupt+0x7a/0xcc
[  208.519741][    C1] [<ffffffff8027c4da>] handle_percpu_devid_irq+0x284/0x59e
[  208.520067][    C1] [<ffffffff80265bd4>] generic_handle_domain_irq+0x76/0xaa
[  208.520434][    C1] [<ffffffff816e7b9e>] riscv_intc_irq+0x6e/0xa2
[  208.520804][    C1] [<ffffffff85b424e4>] handle_riscv_irq+0x2e/0x4c
[  208.521271][    C1] [<ffffffff85b42b7a>] do_irq+0x6a/0xb4
SYZFAIL: failed to recv rpc
fd=3 want=4 recv=0 n=0 (errno 9: Bad file descriptor)

VM DIAGNOSIS:
10:03:38  Registers:
info registers vcpu 0
 pc       ffffffff81ab9390
 mhartid  0000000000000000
 mstatus  0000000a000000a0
 mip      00000000000000a2
 mie      000000000000022a
 mideleg  0000000000000222
 medeleg  000000000000b109
 mtvec    0000000080000520
 stvec    ffffffff80006e1c
 mepc     ffffffff81ab93e6
 sepc     00000000000a377e
 mcause   8000000000000003
 scause   8000000000000005
 mtval    0000000000000000
 stval    0000000000000000
 mscratch 000000008001a000
 sscratch 0000000000000000
 satp     a00f600000108e27
 x0/zero  0000000000000000 x1/ra    ffffffff81ab9390 x2/sp    ff2000000000b810 x3/gp    ffffffff890652c0
 x4/tp    ff6000008d5d9980 x5/t0    ffffffff8023e9e2 x6/t1    00000000000f0000 x7/t2    ffffffff87223478
 x8/s0    ff2000000000b850 x9/s1    ffffffff903aa380 x10/a0   ffffffff903aa3c8 x11/a1   0000000000000000
 x12/a2   0000000000010000 x13/a3   0000000000000000 x14/a4   1ffffffff2075479 x15/a5   ff2000000009d000
 x16/a6   0000000000000000 x17/a7   0000000000010000 x18/s2   0000000000000020 x19/s3   0000000000000000
 x20/s4   0000000000000020 x21/s5   000000000000000f x22/s6   0000000000000020 x23/s7   0000000000000001
 x24/s8   ffffffff903aa3d8 x25/s9   0000000000000020 x26/s10  0000000000000010 x27/s11  ffffffff81ab9332
 x28/t3   0000000000f00000 x29/t4   fffffffef2075470 x30/t5   fffffffef2075471 x31/t6   fffffffff3000000
 f0/ft0   0000000000000000 f1/ft1   0000000000000000 f2/ft2   0000000000000000 f3/ft3   0000000000000000
 f4/ft4   0000000000000000 f5/ft5   0000000000000000 f6/ft6   0000000000000000 f7/ft7   0000000000000000
 f8/fs0   0000000000000000 f9/fs1   0000000000000000 f10/fa0  0000000000000000 f11/fa1  0000000000000000
 f12/fa2  0000000000000000 f13/fa3  0000000000000000 f14/fa4  0000000000000000 f15/fa5  0000000000000000
 f16/fa6  0000000000000000 f17/fa7  0000000000000000 f18/fs2  0000000000000000 f19/fs3  0000000000000000
 f20/fs4  0000000000000000 f21/fs5  0000000000000000 f22/fs6  0000000000000000 f23/fs7  0000000000000000
 f24/fs8  0000000000000000 f25/fs9  0000000000000000 f26/fs10 0000000000000000 f27/fs11 0000000000000000
 f28/ft8  0000000000000000 f29/ft9  0000000000000000 f30/ft10 0000000000000000 f31/ft11 0000000000000000
info registers vcpu 1
 pc       00000000000f2580
 mhartid  0000000000000001
 mstatus  0000000a000040a2
 mip      0000000000000000
 mie      00000000000002aa
 mideleg  0000000000000222
 medeleg  000000000000b109
 mtvec    0000000080000520
 stvec    ffffffff80006e1c
 mepc     ffffffff80017912
 sepc     00000000000d2e90
 mcause   0000000000000009
 scause   0000000000000008
 mtval    0000000000000000
 stval    0000000000000000
 mscratch 0000000080018000
 sscratch ff6000008fe08000
 satp     a00970000010fc17
 x0/zero  0000000000000000 x1/ra    00000000000d2f62 x2/sp    00007fffe8cd97a0 x3/gp    00000000002b2b70
 x4/tp    000000001887d740 x5/t0    0000000000000000 x6/t1    000000000000a030 x7/t2    0000000000000000
 x8/s0    0000000000000000 x9/s1    00000000001b7740 x10/a0   0000000000000000 x11/a1   0000000000000000
 x12/a2   00007fffe8cd97e8 x13/a3   0000000000000000 x14/a4   0000000000989680 x15/a5   0000000000000000
 x16/a6   0000000064000000 x17/a7   0000000000000073 x18/s2   000000000000000c x19/s3   00007fffe8cd9838
 x20/s4   0000000000000000 x21/s5   0000000000032d0b x22/s6   0000000040000001 x23/s7   00000000000001f4
 x24/s8   0000000000003a98 x25/s9   00007fffe8cd9868 x26/s10  00007fffe8cd98a8 x27/s11  0000000000002710
 x28/t3   0000000000000018 x29/t4   000b959ce0000000 x30/t5   ffffffffffffffff x31/t6   000000008048d075
 f0/ft0   0000000000000000 f1/ft1   0000000000000000 f2/ft2   0000000000000000 f3/ft3   0000000000000000
 f4/ft4   0000000000000000 f5/ft5   0000000000000000 f6/ft6   0000000000000000 f7/ft7   0000000000000000
 f8/fs0   0000000000000000 f9/fs1   0000000000000000 f10/fa0  0000000000000000 f11/fa1  0000000000000000
 f12/fa2  0000000000000000 f13/fa3  0000000000000000 f14/fa4  0000000000000000 f15/fa5  0000000000000000
 f16/fa6  0000000000000000 f17/fa7  0000000000000000 f18/fs2  0000000000000000 f19/fs3  0000000000000000
 f20/fs4  0000000000000000 f21/fs5  0000000000000000 f22/fs6  0000000000000000 f23/fs7  0000000000000000
 f24/fs8  0000000000000000 f25/fs9  0000000000000000 f26/fs10 0000000000000000 f27/fs11 0000000000000000
 f28/ft8  0000000000000000 f29/ft9  0000000000000000 f30/ft10 0000000000000000 f31/ft11 0000000000000000
